<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>클로저</title>
<script type="text/javascript">



</script>
</head>
<body>

<div>
	<script type="text/javascript">
	function cbuilder() {
		var exch = 1135.34;
		var getamount = function(usd) { return usd * exch;}
		return getamount;
	}
	
	var getkrw = cbuilder(); // cbuilder_context --> 활성객체 --> 스코프체인 (0: 자신, 1:window) --> exch, getamount
	var usd = 23.5;
	var krw = getkrw(usd); // getamount_context -->활성객체 --> arguments -->스코프체인 (0: 자신, 1:cbuilderobj, 2:window) --> usd
	console.log("krw for usd --> " + usd + " : " + krw);
	//cbuilder의 실행이 끝나면 cbuilder_context는 stack에서 사라지지만, 행당활성(변수)객체는 getamount의 스코프체인에 살아 있어야 한다.
	//클로저(closure): 생명주기가 끝난 외부함수의 변수를 참조하는 함수.
	//클로저가 참조하는 외부변수 (위의 exch)를 free variable(자유변수)라고 함.
	// closing, closed관계 --> closure라고 불림
	
	//일반형식
	function builder() {
		var freevar =1;
		return function(arg) {console.log(arg + ","+ freevar);} //{}속에 args와 freevar로 구성된 코드
	}
	var closure = builder();
	closure(5);
	
	</script>
</div>

</body>
</html>